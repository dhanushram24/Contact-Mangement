/* ═══════════════════════════════════════════════════════════
   Contact Management — Dark Enterprise Theme
   Font: Plus Jakarta Sans + JetBrains Mono
═══════════════════════════════════════════════════════════ */

@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap');

:root {
    --bg:           #0b0e17;
    --surface:      #141824;
    --surface-2:    #1c2133;
    --card:         #1a1f30;
    --card-hover:   #1f2538;
    --border:       #252d42;
    --border-light: #2e3650;

    --accent:       #5b8af0;
    --accent-glow:  rgba(91,138,240,.18);
    --accent-dim:   rgba(91,138,240,.09);
    --accent2:      #9b6ef3;
    --green:        #3ecf8e;
    --green-dim:    rgba(62,207,142,.1);
    --amber:        #f5c842;
    --amber-dim:    rgba(245,200,66,.1);
    --red:          #f06070;
    --red-dim:      rgba(240,96,112,.1);

    --text:         #e2e8f8;
    --text-2:       #a8b4cc;
    --muted:        #5e6a84;
    --white:        #ffffff;

    --font: 'Plus Jakarta Sans', system-ui, sans-serif;
    --mono: 'JetBrains Mono', 'Courier New', monospace;

    --r-sm: 6px; --r-md: 10px; --r-lg: 14px; --r-xl: 20px;
    --shadow-lg: 0 8px 40px rgba(0,0,0,.6);
    --shadow-glow: 0 0 32px rgba(91,138,240,.12);
    --tr: .2s ease;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: var(--font); font-size: 14px; line-height: 1.6;
    color: var(--text); background: var(--bg);
    min-height: 100vh; overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
}
body::before {
    content: ''; position: fixed; inset: 0; z-index: 0; pointer-events: none;
    background:
        radial-gradient(ellipse 80% 60% at 0% 0%,   rgba(91,138,240,.07) 0%, transparent 60%),
        radial-gradient(ellipse 60% 50% at 100% 100%, rgba(155,110,243,.06) 0%, transparent 55%);
}

/* ── Layout ─────────────────────────────────────────────── */
.container { position: relative; z-index: 1; max-width: 1100px; margin: 0 auto; padding: 36px 20px 80px; }

/* ── App header ─────────────────────────────────────────── */
.app-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 36px; animation: fadeDown .45s ease both; }
.app-brand  { display: flex; align-items: center; gap: 12px; }
.app-icon   { width: 42px; height: 42px; background: linear-gradient(135deg, var(--accent), var(--accent2)); border-radius: var(--r-md); display: grid; place-items: center; font-size: 20px; box-shadow: 0 0 20px rgba(91,138,240,.3); flex-shrink: 0; }
.app-title  { font-size: 1.1rem; font-weight: 800; letter-spacing: -.4px; }
.app-sub    { font-size: .72rem; color: var(--muted); margin-top: 1px; }

.session-badge { display: none; align-items: center; gap: 10px; background: var(--surface-2); border: 1px solid var(--border); border-radius: 99px; padding: 5px 12px 5px 6px; font-size: .78rem; }
.session-badge.show { display: flex; animation: fadeDown .3s ease both; }
.session-avatar { width: 28px; height: 28px; border-radius: 50%; background: linear-gradient(135deg, var(--accent), var(--accent2)); display: grid; place-items: center; font-size: 11px; font-weight: 800; color: var(--white); flex-shrink: 0; }
.session-name { font-weight: 700; color: var(--text); }
.session-db   { font-size: .68rem; color: var(--muted); }

.btn-logout { display: none; margin-left: 4px; padding: 5px 12px; background: var(--red-dim); border: 1px solid rgba(240,96,112,.25); border-radius: var(--r-sm); color: var(--red); font-family: var(--font); font-size: .74rem; font-weight: 700; cursor: pointer; transition: var(--tr); }
.btn-logout:hover { background: rgba(240,96,112,.18); }
.btn-logout.show  { display: inline-block; }

/* ── Login card ─────────────────────────────────────────── */
.login-section {
    max-width: 440px; background: var(--card);
    border: 1px solid var(--border); border-radius: var(--r-xl);
    box-shadow: var(--shadow-lg), var(--shadow-glow);
    padding: 40px; animation: fadeUp .5s ease both;
    position: relative; overflow: hidden;
}
.login-section::before {
    content: ''; position: absolute; top: -70px; right: -70px;
    width: 200px; height: 200px;
    background: radial-gradient(circle, rgba(91,138,240,.1), transparent 70%);
    pointer-events: none;
}
.login-section h2 { font-size: 1.55rem; font-weight: 800; letter-spacing: -.5px; margin-bottom: 4px; color: var(--white); }
.login-sub { font-size: .83rem; color: var(--muted); margin-bottom: 30px; }

/* ── Form ───────────────────────────────────────────────── */
.form-group { margin-bottom: 18px; }
label { display: block; font-size: .7rem; font-weight: 800; color: var(--text-2); text-transform: uppercase; letter-spacing: .7px; margin-bottom: 7px; }
input[type="text"], input[type="password"] {
    width: 100%; background: var(--surface); border: 1.5px solid var(--border);
    border-radius: var(--r-md); padding: 11px 14px;
    font-family: var(--font); font-size: .9rem; color: var(--text); outline: none;
    transition: border-color var(--tr), box-shadow var(--tr);
}
input[type="text"]:focus, input[type="password"]:focus {
    border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-glow);
}
input::placeholder { color: var(--muted); }

button#loginBtn {
    width: 100%; padding: 13px; margin-top: 6px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none; border-radius: var(--r-md); color: var(--white);
    font-family: var(--font); font-size: .92rem; font-weight: 700; letter-spacing: .2px;
    cursor: pointer; box-shadow: 0 4px 20px rgba(91,138,240,.3);
    transition: opacity var(--tr), transform var(--tr), box-shadow var(--tr);
}
button#loginBtn:hover   { opacity: .88; transform: translateY(-1px); box-shadow: 0 6px 28px rgba(91,138,240,.4); }
button#loginBtn:active  { transform: translateY(0); }
button#loginBtn:disabled { opacity: .45; cursor: not-allowed; transform: none; }

/* ── Error ──────────────────────────────────────────────── */
.error { display: none; background: var(--red-dim); border: 1px solid rgba(240,96,112,.25); border-radius: var(--r-sm); color: var(--red); font-size: .83rem; padding: 10px 14px; margin-top: 14px; }
.error.show { display: block; animation: shake .35s ease; }

/* ── Loading ────────────────────────────────────────────── */
.loading { display: none; flex-direction: column; align-items: center; gap: 14px; padding: 52px 20px; }
.loading.show { display: flex; }
.spinner { width: 36px; height: 36px; border: 3px solid var(--border); border-top-color: var(--accent); border-radius: 50%; animation: spin .75s linear infinite; }
.loading-text { color: var(--muted); font-size: .84rem; }

/* ── Stat strip ─────────────────────────────────────────── */
.stat-strip { display: none; grid-template-columns: repeat(auto-fit, minmax(155px,1fr)); gap: 12px; margin-bottom: 16px; }
.stat-strip.show { display: grid; animation: fadeUp .4s ease both; }
.stat-card { background: var(--card); border: 1px solid var(--border); border-radius: var(--r-lg); padding: 16px 18px; position: relative; overflow: hidden; }
.stat-card::after { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; border-radius: 3px 0 0 3px; }
.stat-card.c-blue::after   { background: var(--accent); }
.stat-card.c-purple::after { background: var(--accent2); }
.stat-card.c-green::after  { background: var(--green); }
.stat-card.c-amber::after  { background: var(--amber); }
.stat-label { font-size: .65rem; font-weight: 800; text-transform: uppercase; letter-spacing: .7px; color: var(--muted); margin-bottom: 6px; }
.stat-val { font-size: 1.4rem; font-weight: 800; letter-spacing: -.5px; line-height: 1; }
.stat-val.sm { font-size: .88rem; letter-spacing: -.2px; }
.c-blue   .stat-val { color: var(--accent); }
.c-purple .stat-val { color: var(--accent2); }
.c-green  .stat-val { color: var(--green); }
.c-amber  .stat-val { color: var(--amber); }

/* token row */
.token-strip { display: none; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r-md); padding: 11px 16px; margin-bottom: 16px; }
.token-strip.show { display: block; animation: fadeUp .4s .05s ease both; }
.token-strip .tlabel { font-size: .65rem; font-weight: 800; text-transform: uppercase; letter-spacing: .7px; color: var(--muted); margin-bottom: 4px; }
.token-strip .tval { font-family: var(--mono); font-size: .72rem; color: var(--accent2); word-break: break-all; }

/* hide old user-info div */
.user-info, .user-info.show { display: none !important; }

/* ── Tabs wrapper ───────────────────────────────────────── */
.tabs-wrapper { display: none; background: var(--card); border: 1px solid var(--border); border-radius: var(--r-xl); overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,.4); }
.tabs-wrapper.show { display: block; animation: fadeUp .4s .08s ease both; }

.tabs-nav { display: flex; background: var(--surface); border-bottom: 1px solid var(--border); padding: 0 4px; gap: 2px; }
.tab-btn {
    position: relative; width: auto; padding: 13px 22px;
    background: none; border: none; border-bottom: 2px solid transparent;
    margin-bottom: -1px; font-family: var(--font); font-size: .82rem; font-weight: 600;
    color: var(--muted); cursor: pointer;
    display: flex; align-items: center; gap: 7px;
    transition: color var(--tr), border-color var(--tr);
    transform: none; box-shadow: none;
}
.tab-btn:hover  { color: var(--text); transform: none; box-shadow: none; }
.tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); transform: none; box-shadow: none; }

.tab-count { font-size: .66rem; font-weight: 800; padding: 2px 7px; border-radius: 20px; background: var(--accent-dim); color: var(--accent); border: 1px solid rgba(91,138,240,.2); }
.tab-btn:not(.active) .tab-count { background: rgba(255,255,255,.04); color: var(--muted); border-color: var(--border); }

.tab-panel { display: none; padding: 24px; }
.tab-panel.active { display: block; animation: fadeUp .3s ease both; }

.panel-header { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px; margin-bottom: 18px; }
.panel-header h3 { font-size: .93rem; font-weight: 800; color: var(--white); letter-spacing: -.3px; margin-bottom: 0; display: flex; align-items: center; gap: 8px; }
.panel-header h3 .dot { width: 7px; height: 7px; border-radius: 50%; background: var(--accent); box-shadow: 0 0 7px var(--accent); display: inline-block; }
.panel-header h3 .dot.amber { background: var(--amber); box-shadow: 0 0 7px var(--amber); }
.panel-meta { font-size: .74rem; color: var(--muted); }

/* ── Contact cards grid ─────────────────────────────────── */
#contactsList { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px,1fr)); gap: 12px; }
.contact-card { background: var(--surface-2); border: 1px solid var(--border); border-radius: var(--r-lg); padding: 15px 17px; transition: border-color var(--tr), background var(--tr), transform var(--tr); }
.contact-card:hover { border-color: var(--border-light); background: var(--card-hover); transform: translateY(-1px); }
.contact-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 11px; gap: 8px; }
.contact-name { font-size: .88rem; font-weight: 700; color: var(--white); letter-spacing: -.2px; }
.contact-status { font-size: .63rem; font-weight: 800; text-transform: uppercase; letter-spacing: .6px; padding: 2px 8px; border-radius: 20px; white-space: nowrap; flex-shrink: 0; }
.status-active   { background: var(--green-dim); color: var(--green); border: 1px solid rgba(62,207,142,.2); }
.status-inactive { background: rgba(255,255,255,.04); color: var(--muted); border: 1px solid var(--border); }
.contact-details { display: flex; flex-direction: column; gap: 4px; }
.detail-item { font-size: .77rem; color: var(--text-2); display: flex; gap: 6px; }
.detail-label { font-weight: 700; color: var(--muted); flex-shrink: 0; min-width: 44px; }

/* ── Filter bar ─────────────────────────────────────────── */
.filter-bar { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 14px; }
.filter-select, .filter-input {
    background: var(--surface); border: 1.5px solid var(--border);
    border-radius: var(--r-sm); padding: 7px 11px;
    font-family: var(--font); font-size: .8rem; color: var(--text); outline: none;
    transition: border-color var(--tr), box-shadow var(--tr); width: auto;
}
.filter-select:focus, .filter-input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-glow); }
.filter-select { cursor: pointer; }
.filter-select option { background: var(--surface-2); }
.filter-input { flex: 1; min-width: 140px; }
.filter-input::placeholder { color: var(--muted); }

/* ── Tickets table ──────────────────────────────────────── */
.tbl-wrap { display: none; border: 1px solid var(--border); border-radius: var(--r-lg); overflow: hidden; overflow-x: auto; margin-bottom: 14px; }
.tbl-wrap.show { display: block; }
#ticketsTable { width: 100%; border-collapse: collapse; font-size: .8rem; min-width: 680px; }
#ticketsTable thead tr { background: var(--surface); }
#ticketsTable th { padding: 9px 13px; text-align: left; font-size: .65rem; font-weight: 800; text-transform: uppercase; letter-spacing: .7px; color: var(--muted); border-bottom: 1px solid var(--border); white-space: nowrap; }
#ticketsTable tbody tr { border-bottom: 1px solid var(--border); transition: background var(--tr); }
#ticketsTable tbody tr:last-child { border-bottom: none; }
#ticketsTable tbody tr:hover { background: rgba(255,255,255,.025); }
#ticketsTable td { padding: 10px 13px; vertical-align: middle; color: var(--text-2); }
.ticket-id { font-family: var(--mono); font-size: .74rem; color: var(--accent); font-weight: 500; }
.subject-cell { font-weight: 600; color: var(--text); max-width: 190px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.muted-cell   { color: var(--muted); font-size: .76rem; }
.mono-cell    { font-family: var(--mono); font-size: .72rem; color: var(--text-2); }
.date-cell    { font-family: var(--mono); font-size: .69rem; color: var(--muted); white-space: nowrap; }
.contact-name-cell { font-weight: 700; color: var(--text); }

.badge { display: inline-flex; align-items: center; gap: 5px; padding: 2px 9px; border-radius: 20px; font-size: .67rem; font-weight: 800; white-space: nowrap; border: 1px solid transparent; }
.badge::before { content: ''; width: 5px; height: 5px; border-radius: 50%; flex-shrink: 0; }
.b-open    { background: rgba(91,138,240,.1);  color: var(--accent);  border-color: rgba(91,138,240,.2);  } .b-open::before    { background: var(--accent); }
.b-closed  { background: var(--green-dim); color: var(--green);   border-color: rgba(62,207,142,.2);  } .b-closed::before  { background: var(--green); }
.b-pending { background: var(--amber-dim); color: var(--amber);   border-color: rgba(245,200,66,.2);  } .b-pending::before { background: var(--amber); }
.b-unknown { background: rgba(255,255,255,.04); color: var(--muted); border-color: var(--border); }         .b-unknown::before { background: var(--muted); }
.channel-tag { background: rgba(155,110,243,.1); color: var(--accent2); border: 1px solid rgba(155,110,243,.22); border-radius: 4px; padding: 2px 8px; font-size: .69rem; font-weight: 700; white-space: nowrap; }

#ticketsLoading { display: none; text-align: center; padding: 40px; }
#ticketsLoading.show { display: block; }
#ticketsLoading .spinner { margin: 0 auto 12px; }

.no-contacts { display: none; text-align: center; padding: 48px 20px; color: var(--muted); }
.no-contacts.show { display: block; }
.no-contacts-icon { font-size: 2.4rem; margin-bottom: 10px; opacity: .65; }
.no-contacts p { font-size: .86rem; }

/* ── Pagination ─────────────────────────────────────────── */
.pagination { display: none; align-items: center; justify-content: flex-end; gap: 10px; margin-top: 6px; font-size: .79rem; flex-wrap: wrap; }
.pagination.show { display: flex; }
.page-info    { color: var(--muted); flex: 1; }
.page-current { font-weight: 800; color: var(--text); }
.page-btn { width: auto; padding: 6px 14px; background: var(--surface); border: 1.5px solid var(--border); border-radius: var(--r-sm); color: var(--text-2); font-family: var(--font); font-size: .77rem; font-weight: 700; cursor: pointer; transform: none; box-shadow: none; transition: border-color var(--tr), color var(--tr); }
.page-btn:hover { border-color: var(--accent); color: var(--accent); transform: none; box-shadow: none; }
.page-btn:disabled { opacity: .3; cursor: not-allowed; }

/* ── Token countdown ────────────────────────────────────── */
#tokenCountdown { font-family: var(--mono); font-size: .8rem; font-weight: 500; letter-spacing: .5px; transition: color var(--tr); }
#tokenCountdown.warning { color: var(--amber); }
#tokenCountdown.expired { color: var(--red); }

/* ── Animations ─────────────────────────────────────────── */
@keyframes fadeUp   { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }
@keyframes fadeDown { from{opacity:0;transform:translateY(-10px)} to{opacity:1;transform:translateY(0)} }
@keyframes spin     { to{transform:rotate(360deg)} }
@keyframes shake    { 0%,100%{transform:translateX(0)} 20%,60%{transform:translateX(-5px)} 40%,80%{transform:translateX(5px)} }

/* ── Scrollbar ──────────────────────────────────────────── */
::-webkit-scrollbar       { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: var(--surface); }
::-webkit-scrollbar-thumb { background: var(--border-light); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--accent); }

/* ── Responsive ─────────────────────────────────────────── */
@media (max-width: 768px) {
    .container  { padding: 20px 12px 60px; }
    .login-section { padding: 28px 20px; }
    .stat-strip { grid-template-columns: 1fr 1fr; }
    .tab-panel  { padding: 16px; }
    #contactsList { grid-template-columns: 1fr; }
    #ticketsTable th:nth-child(n+9), #ticketsTable td:nth-child(n+9) { display: none; }
}
@media (max-width: 480px) {
    .stat-strip { grid-template-columns: 1fr; }
    .filter-bar { flex-direction: column; }
    .filter-select, .filter-input { width: 100%; }
    .app-header { flex-direction: column; align-items: flex-start; gap: 10px; }
}