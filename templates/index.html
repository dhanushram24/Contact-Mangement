<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Management</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<div class="container">

    <!-- â•â• App Header â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <header class="app-header">
        <div class="app-brand">
            <div class="app-icon">ðŸ—‚</div>
            <div>
                <div class="app-title">Contact Management</div>
                <div class="app-sub">Paramantra CRM</div>
            </div>
        </div>

        <!-- shown after login -->
        <div class="session-badge" id="sessionBadge">
            <div class="session-avatar" id="sessionAvatar">AB</div>
            <div>
                <div class="session-name" id="sessionName">â€”</div>
                <div class="session-db"   id="sessionDb">â€”</div>
            </div>
        </div>
        <button class="btn-logout" id="logoutBtn">Logout</button>
    </header>

    <!-- â•â• Login Card â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="login-section" id="loginSection">
        <h2>Welcome back</h2>
        <p class="login-sub">Sign in to manage contacts &amp; tickets</p>

        <form id="loginForm">
            <div class="form-group">
                <label for="username">Username</label>
                <input
                    id="username" type="text"
                    placeholder="Enter your username"
                    value="abadmin" required
                    autocomplete="username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input
                    id="password" type="password"
                    placeholder="Enter your password"
                    required autocomplete="current-password">
            </div>
            <button type="submit" id="loginBtn">Login</button>
        </form>

        <div class="error" id="error"></div>
    </div>

    <!-- â•â• Global loading â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p class="loading-text">Authenticatingâ€¦</p>
    </div>

    <!-- â•â• Stat strip (post-login) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="stat-strip" id="statStrip">
        <div class="stat-card c-blue">
            <div class="stat-label">Username</div>
            <div class="stat-val sm" id="statUser">â€”</div>
        </div>
        <div class="stat-card c-purple">
            <div class="stat-label">Database</div>
            <div class="stat-val sm" id="statDb">â€”</div>
        </div>
        <div class="stat-card c-green">
            <div class="stat-label">Total Contacts</div>
            <div class="stat-val" id="statContacts">0</div>
        </div>
        <div class="stat-card c-amber">
            <div class="stat-label">Token Expires In</div>
            <div class="stat-val sm">
                <span id="tokenCountdown">â€”</span>
            </div>
        </div>
    </div>

    <!-- â•â• Token strip â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="token-strip" id="tokenStrip">
        <div class="tlabel">Access Token</div>
        <div class="tval" id="displayToken">â€”</div>
    </div>

    <!-- keep for JS compat (hidden by CSS) -->
    <div class="user-info" id="userInfo">
        <span id="displayUsername"></span>
        <span id="displayDatabase"></span>
        <span id="displayCount"></span>
    </div>

    <!-- â•â• Tabs â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tabs-wrapper" id="tabsWrapper">
        <nav class="tabs-nav">
            <button class="tab-btn active" id="tabContacts"
                    onclick="switchTab('contacts')">
                ðŸ‘¥ Contacts
                <span class="tab-count" id="contactTabCount">0</span>
            </button>
            <button class="tab-btn" id="tabTickets"
                    onclick="switchTab('tickets')">
                ðŸŽ« Tickets
                <span class="tab-count" id="ticketTabCount">0</span>
            </button>
        </nav>

        <!-- â”€â”€ Contacts panel â”€â”€ -->
        <div class="tab-panel active" id="panelContacts">
            <div class="panel-header">
                <h3>
                    <span class="dot"></span>
                    Your Contacts
                </h3>
                <span class="panel-meta" id="contactsMeta"></span>
            </div>

            <!-- contacts grid rendered here by JS -->
            <div id="contactsList"></div>

            <div class="no-contacts" id="noContacts">
                <div class="no-contacts-icon">ðŸ“­</div>
                <p>No contacts found for this user.</p>
            </div>
        </div>

        <!-- â”€â”€ Tickets panel â”€â”€ -->
        <div class="tab-panel" id="panelTickets">
            <div class="panel-header">
                <h3>
                    <span class="dot amber"></span>
                    Tickets + Contact Info
                </h3>
                <span class="panel-meta" id="ticketsMeta">Joined on customer_id = contact.id</span>
            </div>

            <!-- Filter bar -->
            <div class="filter-bar">
                <select class="filter-select" id="statusFilter"
                        onchange="applyTicketFilter()">
                    <option value="">All Statuses</option>
                    <option value="0">Status 0 â€” Open</option>
                    <option value="1">Status 1 â€” Open</option>
                    <option value="6">Status 6 â€” Closed</option>
                    <option value="9">Status 9 â€” Pending</option>
                </select>

                <select class="filter-select" id="channelFilter"
                        onchange="applyTicketFilter()">
                    <option value="">All Channels</option>
                    <option value="2">Telephone</option>
                    <option value="3">SMS</option>
                    <option value="4">Hotline</option>
                    <option value="8">Web</option>
                </select>

                <input class="filter-input" id="subjectSearch"
                       placeholder="Search subjectâ€¦"
                       oninput="applyTicketFilter()">
            </div>

            <!-- Tickets loading spinner -->
            <div id="ticketsLoading">
                <div class="spinner"></div>
                <p class="loading-text">Loading ticketsâ€¦</p>
            </div>

            <!-- Tickets table -->
            <div class="tbl-wrap" id="ticketsTableWrap">
                <table id="ticketsTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Subject</th>
                            <th>Status</th>
                            <th>Category</th>
                            <th>Channel</th>
                            <th>Contact Name</th>
                            <th>Phone / Fax</th>
                            <th>Email</th>
                            <th>Created</th>
                            <th>Updated</th>
                        </tr>
                    </thead>
                    <tbody id="ticketsBody"></tbody>
                </table>
            </div>

            <div class="no-contacts" id="noTickets">
                <div class="no-contacts-icon">ðŸŽ«</div>
                <p>No tickets found.</p>
            </div>

            <!-- Pagination -->
            <div class="pagination" id="ticketsPagination">
                <span class="page-info" id="pageInfo"></span>
                <button class="page-btn" onclick="changePage(-1)">â€¹ Prev</button>
                <span class="page-current" id="pageCurrent">Page 1</span>
                <button class="page-btn" onclick="changePage(1)">Next â€º</button>
            </div>
        </div>
        <!-- /panelTickets -->

    </div>
    <!-- /tabsWrapper -->

</div>
<!-- /container -->

<script src="/static/app.js"></script>
</body>
</html>